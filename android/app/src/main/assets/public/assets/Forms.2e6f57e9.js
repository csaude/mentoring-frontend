var Me=Object.defineProperty;var je=(s,l,e)=>l in s?Me(s,l,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[l]=e;var S=(s,l,e)=>(je(s,typeof l!="symbol"?l+"":l,e),e);import{b as ie,d as ne,Q as Je}from"./selection.524514e5.js";import{e as H,Q as ue,a as Q,b as de,c as V,d as Ae,f as $,u as Ke}from"./loading.39fe8a47.js";import{Q as U,g as T}from"./QBtn.bc754139.js";import{Q as G,u as _e}from"./dialog.985b2618.js";import{Q as We}from"./QPageSticky.692f4600.js";import{M as fe,c as ge,d as Z}from"./index.806c5219.js";import{P as Te,u as ke,b as Ee,p as Fe,a as Se}from"./programmaticAreaService.1f7a5697.js";import{f as Xe,g as Re,b as $e,U as Qe,Q as Ye}from"./QSpinnerRings.4e4bdf31.js";import{Q as re,u as Pe,a as pe,q as Ue,b as He}from"./questionCategoryService.240c6402.js";import{r as g,i as se,P as Be,o as Ve,c as M,U as W,af as le,X as m,f as t,W as a,_ as p,Y as h,V as qe,a0 as be,G as Y,$ as ve,ah as Ze,F as et}from"./index.8cc0be75.js";import{Q as tt,_ as at}from"./mentoring.31b55a37.js";import{Q as we}from"./QBanner.7f8ff127.js";import{i as ot,h as st}from"./QCheckbox.435b6968.js";import{Q as rt}from"./QCard.2b2ac6e8.js";import{v as lt}from"./v4.90f1a8cc.js";import"./format.2d67676e.js";import"./_commonjsHelpers.468b0bfa.js";import"./axios.0ed95acd.js";class B extends fe{static fields(){return{id:this.number(()=>0),uuid:this.attr(""),code:this.attr(""),description:this.attr("")}}}S(B,"entity","evaluation_type"),S(B,"primaryKey","id"),S(B,"piniaOptions",{persist:!0});class j extends fe{static fields(){return{id:this.number(()=>0),uuid:this.attr(""),code:this.attr(""),description:this.attr("")}}}S(j,"entity","response_type"),S(j,"primaryKey","id"),S(j,"piniaOptions",{persist:!0});class I extends fe{static fields(){return{id:this.attr(null),uuid:this.attr(""),mandatory:this.attr(""),sequence:this.attr(""),assessmentType:this.attr(""),anwserType:this.attr(""),applicable:this.attr(""),selected:this.boolean(!1),lifeCycleStatus:this.attr(""),form_id:this.attr(""),question_id:this.attr(""),evaluation_type_id:this.attr(""),response_type_id:this.attr(""),form:this.belongsTo(ee,"form_id"),question:this.belongsTo(re,"question_id"),evaluationType:this.belongsTo(B,"evaluation_type_id"),responseType:this.belongsTo(j,"response_type_id")}}}S(I,"entity","forms_questions"),S(I,"primaryKey","id"),S(I,"piniaOptions",{persist:!0});class ee extends fe{static fields(){return{id:this.attr(null),uuid:this.attr(""),code:this.attr(""),description:this.attr(""),name:this.attr(""),targetPatient:this.attr(""),targetFile:this.attr(""),lifeCycleStatus:this.attr(""),createdBy:this.attr(null),createdAt:this.attr(null),programmatic_area_id:this.attr(""),partner_id:this.attr(""),programmaticArea:this.belongsTo(Te,"programmatic_area_id"),partner:this.belongsTo(Xe,"partner_id"),formQuestions:this.hasMany(I,"form_id")}}}S(ee,"entity","forms"),S(ee,"primaryKey","id"),S(ee,"piniaOptions",{persist:!0});function he(){function s(e){return new B({id:e.id,uuid:e.uuid,code:e.code,description:e.description})}function l(e){return{id:e.id,uuid:e.uuid,code:e.code,description:e.description}}return{createEvaluationTypeFromDTO:s,createDTOFromEvaluationType:l}}function Ce(){function s(e){return new j({id:e.id,uuid:e.uuid,code:e.code,description:e.description})}function l(e){return{id:e.id,uuid:e.uuid,code:e.code,description:e.description}}return{createResponseTypeFromDTO:s,createDTOFromResponseType:l}}function it(){function s(e){const{createQuestionFromDTO:y}=Pe(),{createEvaluationTypeFromDTO:w}=he(),{createResponseTypeFromDTO:q}=Ce();return new I({id:e.id,uuid:e.uuid,mandatory:e.mandatory,sequence:e.sequence,applicable:e.applicable,createdAt:e.createdAt,createdBy:e.createdBy,question:y(e.question),evaluationType:w(e.evaluationType),responseType:q(e.responseType)})}function l(e){const{createDTOFromQuestion:y}=Pe(),{createDTOFromEvaluationType:w}=he(),{createDTOFromResponseType:q}=Ce();return{id:e.id,uuid:e.uuid,mandatory:e.mandatory,sequence:e.sequence,applicable:e.applicable,createdAt:e.createdAt,createdBy:e.createdBy,questionDTO:y(e.question),evaluationType:w(e.evaluationType),responseType:q(e.responseType)}}return{createFormQuestionFromDTO:s,createDTOFromFormQuestion:l}}function Ie(){function s(e){const{createProgrammaticAreaFromDTO:y}=ke(),{createPartnerFromDTO:w}=Re();return new ee({id:e.id,uuid:e.uuid,code:e.code,name:e.name,description:e.description,targetPatient:e.targetPatient,lifeCycleStatus:e.lifeCycleStatus,targetFile:e.targetFile,createdAt:e.createdAt,createdBy:e.createdBy,programmaticArea:y(e.programmaticArea),partner:w(e.partner)})}function l(e){const{createDTOFromProgrammaticArea:y}=ke(),{createDTOFromPartner:w}=Re();return{id:e.id,uuid:e.uuid,code:e.code,lifeCycleStatus:e.lifeCycleStatus,name:e.name,description:e.description,targetPatient:e.targetPatient,targetFile:e.targetFile,createdAt:e.createdAt,createdBy:e.createdBy,programmaticAreaDTO:y(e.programmaticArea),partnerDTO:w(e.partner)}}return{createFormFromDTO:s,createDTOFromForm:l}}const X=ge(ee),{createFormFromDTO:Oe}=Ie();var K={async search(s){return await Z().get(`/forms/search?${new URLSearchParams(s).toString()}`).then(l=>(this.generateAndSaveEntityFromDTO(l.data),l)).catch(l=>l)},async saveOrUpdate(s){return await Z().post("/forms/saveOrUpdate",s).then(l=>{if(l.status===201){const e=Oe(l.data);X.save(e)}return l}).catch(l=>l)},async changeLifeCycleStatus(s){return await Z().patch("/forms/changeLifeCicleStatus",s).then(l=>l).catch(l=>l)},generateAndSaveEntityFromDTO(s){s.forEach(l=>{const e=Oe(l);X.save(e)})},deleteAllFromStorage(){X.flush()},piniaGetAll(){return X.query().orderBy("description","asc").get()},getFormList(){return X.query().withAllRecursive(2).orderBy("id","asc").get()},getById(s){return X.query().withAllRecursive(2).where("id",s).orderBy("id","asc").first()},update(s){X.save(s)}};const nt={class:"q-pt-sm",style:{height:"100%"}},ut={class:"q-ma-md q-pa-md page-container"},dt={class:"row"},ct={class:"q-mt-lg q-mb-md"},mt={class:"row items-center q-mb-md"},pt={class:"full-width row flex-center text-primary q-gutter-sm text-body2"},vt={class:"col"},ft={__name:"Search",emits:["goToForms"],setup(s,{emit:l}){const e=g({code:"",name:"",program:new Ee,programmaticArea:new Te});se("step");const y=g([]),w=Be(g("")),q=g(!1),A=g([]),{alertError:k,alertSucess:R,alertWarningAction:O}=_e(),{createDTOFromForm:D}=Ie(),N=[{name:"name",align:"left",label:"Nome",field:v=>v.name,sortable:!1},{name:"programmaticArea",align:"left",label:"\xC1rea de Mentoria",field:v=>v.programmaticArea.name,sortable:!1},{name:"options",align:"left",label:"Op\xE7\xF5es",sortable:!1}],P=l,C=g(new $e);Ve(()=>{C.value=JSON.parse(JSON.stringify(Qe.getLogedUser()))});const L=M(()=>Fe.piniaGetAll()),z=M(()=>e.value.program!==null&&e.value.program!==void 0?Se.getProgrammaticAreasByProgramaId(e.value.program.id):null),te=(v,n,f)=>{const E=z;v===""?n(()=>{A.value=E.value.map(J=>J)}):E.value.length===0?n(()=>{A.value=[]}):n(()=>{A.value=E.value.map(J=>J).filter(J=>J&&J.name.toLowerCase().indexOf(v.toLowerCase())!==-1)})},ae=()=>{e.value.program=""},d=v=>v.lifeCycleStatus==="ACTIVE",i=v=>{var n="";v.lifeCycleStatus==="ACTIVE"?n="Confirma inactivar a tabela de compet\xEAncias?":n="Confirma activar a tabela de compet\xEAncias?",O(n).then(f=>{f&&u(v)})},u=v=>{v.lifeCycleStatus==="ACTIVE"?v.lifeCycleStatus="INACTIVE":v.lifeCycleStatus="ACTIVE",K.changeLifeCycleStatus(D(v)).then(n=>{R("Opera\xE7\xE3o efectuada com sucesso"),K.update(v)}).catch(n=>{v.lifeCycleStatus==="ACTIVE"?v.lifeCycleStatus="INACTIVE":v.lifeCycleStatus="ACTIVE",console.error("Error",n.message),k("Ocorreu um erro inesperado nesta opera\xE7\xE3o.")})},c=v=>{w.value=v,q.value=!1,P("goToForms",w.value)},x=()=>{K.deleteAllFromStorage();const v={code:e.value.code,name:e.value.name,program:e.value.program.uuid,programmaticAreaCode:e.value.programmaticArea.code};Object.keys(v).forEach(n=>v[n]===""&&delete v[n]),K.search(v).then(n=>{y.value=K.getFormList()}).catch(n=>{console.error(n)})},ye=()=>{w=g(""),K.deleteAllFromStorage(),y.value=[]};return(v,n)=>(W(),le("div",nt,[m("div",ut,[m("div",dt,[t(H,{class:"col","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0","onUpdate:modelValue":[n[0]||(n[0]=f=>ae(v.val)),n[1]||(n[1]=f=>e.value.program=f)],dense:"",outlined:"",ref:"programRef","lazy-rules":"",modelValue:e.value.program,options:L.value,"option-value":"id","option-label":"name",label:"Programa"},{"no-option":a(()=>[t(ie,null,{default:a(()=>[t(ne,{class:"text-grey"},{default:a(()=>n[8]||(n[8]=[p(" Sem Resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options"]),t(H,{class:"col q-ml-md","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",dense:"",outlined:"",ref:"programmaticAreaRef","lazy-rules":"",modelValue:e.value.programmaticArea,"onUpdate:modelValue":n[2]||(n[2]=f=>e.value.programmaticArea=f),options:A.value,"option-value":"id","option-label":"name",onFilter:te,label:"\xC1rea de Mentoria"},{"no-option":a(()=>[t(ie,null,{default:a(()=>[t(ne,{class:"text-grey"},{default:a(()=>n[9]||(n[9]=[p(" Sem Resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options"]),t(G,{outlined:"",label:"C\xF3digo",dense:"",ref:"codeRef",class:"col q-ml-md",modelValue:e.value.code,"onUpdate:modelValue":n[4]||(n[4]=f=>e.value.code=f)},{append:a(()=>[t(U,{name:"close",onClick:n[3]||(n[3]=f=>e.value.code=""),class:"cursor-pointer"})]),_:1},8,["modelValue"]),t(G,{outlined:"",label:"Nome",dense:"",ref:"nameRef",class:"col q-ml-md",modelValue:e.value.name,"onUpdate:modelValue":n[6]||(n[6]=f=>e.value.name=f)},{append:a(()=>[t(U,{name:"close",onClick:n[5]||(n[5]=f=>e.value.name=""),class:"cursor-pointer"})]),_:1},8,["modelValue"]),t(ue),t(T,{onClick:x,class:"q-ml-md q-mb-xs float-right",square:"",color:"primary",icon:"search"},{default:a(()=>[t(Q,{class:"bg-green-5"},{default:a(()=>n[10]||(n[10]=[p("Pesquisar")])),_:1})]),_:1}),t(T,{onClick:ye,class:"q-ml-md q-mb-xs float-right",square:"",color:"amber",icon:"clear"},{default:a(()=>[t(Q,{class:"bg-amber-5"},{default:a(()=>n[11]||(n[11]=[p("Limpar")])),_:1})]),_:1})]),m("div",ct,[m("div",mt,[t(U,{name:"search",size:"sm"}),n[12]||(n[12]=m("span",{class:"q-pl-sm text-subtitle2"},"Resultado da Pesquisa",-1))]),t(Je,{color:"pink-13",size:"1px"})]),m("div",null,[t(Ae,{class:"col",dense:"",rows:y.value,columns:N,"row-key":"id"},{"no-data":a(({icon:f,filter:E})=>[m("div",pt,[n[13]||(n[13]=m("span",null," Sem resultados para visualizar ",-1)),t(U,{size:"2em",name:E?"filter_b_and_w":f},null,8,["name"])])]),body:a(f=>[t(de,{props:f},{default:a(()=>[t(V,{key:"name",props:f},{default:a(()=>[p(h(f.row.name),1)]),_:2},1032,["props"]),t(V,{key:"programmaticArea",props:f},{default:a(()=>[p(h(f.row.programmaticArea.name),1)]),_:2},1032,["props"]),t(V,{key:"options",props:f},{default:a(()=>[m("div",vt,[t(T,{flat:"",round:"",class:"q-ml-md",color:d(f.row)?"green":"red",icon:"circle",onClick:E=>i(f.row)},{default:a(()=>[t(Q,{class:"bg-green-5"},{default:a(()=>[p(h(d(f.row)?"Inactivar Tabela de Compet\xEAncias":"Activar Tabela de Compet\xEAncias"),1)]),_:2},1024)]),_:2},1032,["color","onClick"]),t(T,{flat:"",round:"",class:"q-ml-md",color:"yellow-9",icon:"edit",onClick:E=>c(f.row)},{default:a(()=>[t(Q,{class:"bg-green-5"},{default:a(()=>n[14]||(n[14]=[p("Editar Tabela de Compet\xEAncias")])),_:1})]),_:2},1032,["onClick"])])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows"])]),t(We,{position:"bottom-right",offset:[20,30],class:"row"},{default:a(()=>[t(T,{round:"",color:"primary",icon:"add",onClick:n[7]||(n[7]=f=>v.$emit("create",!0))},{default:a(()=>[t(Q,{class:"bg-green-5"},{default:a(()=>n[15]||(n[15]=[p("Adicionar Nova Tabela de Compet\xEAncias")])),_:1})]),_:1})]),_:1})])]))}},oe=ge(I),{createFormQuestionFromDTO:gt}=it();var xe={async search(s){return await Z().get(`/formQuestions/getByFormId?${new URLSearchParams(s).toString()}`).then(l=>(this.generateAndSaveEntityFromDTO(l.data),l)).catch(l=>{console.error("Error",l.message)})},generateAndSaveEntityFromDTO(s){s.forEach(l=>{const e=gt(l);oe.save(e)})},deleteAllFromStorage(){oe.flush()},piniaGetAll(){return oe.query().orderBy("id","asc").get()},getFormQuestionList(){return oe.query().withAllRecursive(2).orderBy("id","asc").get()},getById(s){return oe.query().withAllRecursive(2).where("id",s).orderBy("id","asc").first()},async remove(s,l){return await Z().patch(`/formQuestions/remove?${new URLSearchParams(s).toString()}`,l).then(e=>(this.update(l),e)).catch(e=>{console.error("Error",e.message)})},update(s){oe.save(s)}};const ce=ge(j),{createResponseTypeFromDTO:yt}=Ce();var De={async getAll(){return await Z().get("/responseTypes/getAll").then(s=>(this.generateAndSaveEntityFromDTO(s.data),s)).catch(s=>{console.error("Error",s.message)})},generateAndSaveEntityFromDTO(s){s.forEach(l=>{const e=yt(l);ce.save(e)})},deleteAllFromStorage(){ce.flush()},piniaGetAll(){return ce.query().orderBy("description","asc").get()},getByDescription(s){return ce.query().where("description",s).orderBy("description","asc").first()}};const me=ge(B),{createEvaluationTypeFromDTO:bt}=he();var Ne={async getAll(){return await Z().get("/evaluationTypes/getAll").then(s=>(this.generateAndSaveEntityFromDTO(s.data),s)).catch(s=>{console.error("Error",s.message)})},generateAndSaveEntityFromDTO(s){s.forEach(l=>{const e=bt(l);me.save(e)})},deleteAllFromStorage(){me.flush()},piniaGetAll(){return me.query().orderBy("description","asc").get()},getByDescription(s){return me.query().where("description",s).orderBy("description","asc").first()}};const qt={class:"page-container"},wt={class:""},ht={class:"row q-pa-md q-mt-lg"},Ct={class:"q-mx-md"},At={class:"full-width row flex-center text-primary q-gutter-sm text-body2"},_t={class:"col"},Tt={class:"row q-ma-md"},Ft={__name:"AddOrRemoveQuestions",setup(s){const l=se("showAddOrRemoveQuestions"),e=se("selectedForm"),y=g([]),{alertError:w}=_e();g(new I({question:new re({questionCategory:new pe}),evaluationType:new B,responseType:new j}));const q=g(new I({question:new re({questionCategory:new pe}),evaluationType:new B})),A=g([]),k=g([]),R=M(()=>Ue.piniaGetAll()),O=M(()=>De.piniaGetAll()),D=M(()=>Ne.piniaGetAll()),N=(d,i,u)=>{const c=R;d===""?i(()=>{y.value=c.value.map(x=>x)}):c.value.length===0?i(()=>{y.value=[]}):i(()=>{y.value=c.value.map(x=>x).filter(x=>x&&x.category.toLowerCase().indexOf(d.toLowerCase())!==-1)})},P=()=>{be.show({spinner:Ye});const d={code:q.value.question.code,description:q.value.question.question,categoryId:q.value.question.questionCategory.id===void 0?void 0:q.value.question.questionCategory.id};Object.keys(d).forEach(i=>d[i]===""&&delete d[i]),He.search(d).then(i=>{L(i.data),be.hide()}).catch(i=>{be.hide(),console.error(i)})},C=[{name:"questionCategory",align:"left",label:"Categoria",field:d=>d.question.questionCategory,sortable:!1},{name:"question",align:"left",label:"Descri\xE7\xE3o",field:d=>d.question,sortable:!1},{name:"sequence",align:"left",label:"C\xF3digo da Compet\xEAncia",field:d=>d.sequence,sortable:!1},{name:"evaluationType",align:"left",label:"Tipo de Avalia\xE7\xE3o",field:d=>d.evaluationType,sortable:!1},{name:"responseType",align:"left",label:"Tipo de Resposta",field:d=>d.responseType,sortable:!1},{name:"options",align:"left",label:"Op\xE7\xF5es",sortable:!1}],L=d=>{A.value=[],d.forEach(i=>{let u=lt();const c=g(new I({question:new re({questionCategory:new pe}),evaluationType:new B,responseType:new j}));c.value.uuid=u,c.value.question=i,c.value.question.questionCategory=i.questionCategory,c.value.lifeCycleStatus="ACTIVE",A.value.push(c.value)})},z=d=>{if(e.value.formQuestions.filter(c=>c.question.uuid===d.question.uuid&&c.question.questionCategory.uuid===d.question.questionCategory.uuid).length>0){d.selected=!1,w("Esta compet\xEAncia j\xE1 foi associada a esta tabela!");return}k.value.filter(c=>c.question.uuid===d.question.uuid&&c.question.questionCategory.uuid===d.question.questionCategory.uuid).length>0||(d.selected=!0,k.value.push(d),e.value.formQuestions.push(d))},te=()=>{if(k.value.length===0){w("Seleccione pelo menos uma quest\xE3o que pretenda adicionar!");return}k.value.forEach(d=>{if(d.evaluationType===void 0||d.evaluationType===null||d.evaluationType.uuid===""){w("Indique o Tipo de Avalia\xE7\xE3o! Competencia - "+d.question.code),l.value=!0;return}if(d.responseType.uuid===void 0||d.responseType.uuid===null||d.responseType.uuid===""){w("Indique o Tipo de Resposta! Competencia - "+d.question.code),l.value=!0;return}e.value.formQuestions.push(d)}),l.value=!1},ae=()=>{A.value.length=0};return(d,i)=>(W(),qe(rt,{style:{width:"85vw","max-width":"90vw"}},{default:a(()=>[m("div",qt,[m("div",wt,[t(we,{dense:"","inline-actions":"",class:"text-white bg-primary q-px-md"},{action:a(()=>[t(T,{flat:"",round:"",class:"q-ml-md",color:"red",icon:"close",onClick:i[0]||(i[0]=u=>l.value=!1)},{default:a(()=>[t(Q,{class:"bg-green-5"},{default:a(()=>i[11]||(i[11]=[p("Pesquisa de Compet\xEAncias")])),_:1})]),_:1})]),default:a(()=>[i[12]||(i[12]=p(" Pesquisa de Compet\xEAncias "))]),_:1}),m("div",ht,[t(G,{outlined:"",label:"C\xF3digo da Compet\xEAncia",dense:"",ref:"recordCodeRef",class:"col",modelValue:q.value.question.code,"onUpdate:modelValue":[i[2]||(i[2]=u=>q.value.question.code=u),i[3]||(i[3]=u=>d.filter=u)]},{append:a(()=>[t(U,{name:"close",onClick:i[1]||(i[1]=u=>q.value.question.code=""),class:"cursor-pointer"})]),_:1},8,["modelValue"]),t(G,{outlined:"",label:"Descri\xE7\xE3o",dense:"",ref:"descriptionRef",class:"col q-ml-md",modelValue:q.value.question.question,"onUpdate:modelValue":[i[5]||(i[5]=u=>q.value.question.question=u),i[6]||(i[6]=u=>d.filter=u)]},{append:a(()=>[t(U,{name:"close",onClick:i[4]||(i[4]=u=>q.value.question.question=""),class:"cursor-pointer"})]),_:1},8,["modelValue"]),t(H,{class:"col q-ml-md","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:q.value.question.questionCategory,"onUpdate:modelValue":i[7]||(i[7]=u=>q.value.question.questionCategory=u),dense:"",outlined:"",ref:"questionCategoryRef",options:y.value,"option-value":"id","option-label":"category",onFilter:N,label:"Categoria"},{"no-option":a(()=>[t(ie,null,{default:a(()=>[t(ne,{class:"text-grey"},{default:a(()=>i[13]||(i[13]=[p(" Sem Resultados ")])),_:1})]),_:1})]),_:1},8,["modelValue","options"]),t(ue),t(T,{onClick:i[8]||(i[8]=u=>P()),class:"q-ml-md q-mb-xs float-right",square:"",color:"primary",icon:"search"},{default:a(()=>[t(Q,{class:"bg-green-5"},{default:a(()=>i[14]||(i[14]=[p("Pesquisar")])),_:1})]),_:1}),t(T,{onClick:ae,class:"q-ml-md q-mb-xs float-right",square:"",color:"amber",icon:"clear"},{default:a(()=>[t(Q,{class:"bg-amber-5"},{default:a(()=>i[15]||(i[15]=[p("Limpar")])),_:1})]),_:1})]),m("div",Ct,[t(Ae,{class:"col",flat:"",dense:"","wrap-cells":"",rows:A.value,columns:C,"row-key":"id"},{"no-data":a(({icon:u,filter:c})=>[m("div",At,[i[16]||(i[16]=m("span",null," Sem resultados para visualizar ",-1)),t(U,{size:"2em",name:c?"filter_b_and_w":u},null,8,["name"])])]),header:a(u=>[t(de,{class:"text-left bg-grey-3",props:u},{default:a(()=>[t($,{style:{width:"110px"}},{default:a(()=>[p(h(C[0].label),1)]),_:1}),t($,{class:"col"},{default:a(()=>[p(h(C[1].label),1)]),_:1}),t($,{style:{width:"190px"}},{default:a(()=>[p(h(C[2].label),1)]),_:1}),t($,{style:{width:"190px"}},{default:a(()=>[p(h(C[3].label),1)]),_:1}),t($,{style:{width:"190px"}},{default:a(()=>[p(h(C[4].label),1)]),_:1}),t($,{style:{width:"70px"}},{default:a(()=>[p(h(C[5].label),1)]),_:1})]),_:2},1032,["props"])]),body:a(u=>[t(de,{props:u},{default:a(()=>[t(V,{key:"questionCategory",props:u},{default:a(()=>[p(h(u.row.question.questionCategory.category),1)]),_:2},1032,["props"]),t(V,{key:"question",props:u},{default:a(()=>[p(h(u.row.question.question),1)]),_:2},1032,["props"]),t(V,{key:"sequence",props:u},{default:a(()=>[t(G,{ref:"recodeCodeRef",class:"vertical-middle",dense:"",outlined:"",disable:"",modelValue:u.row.question.code,"onUpdate:modelValue":c=>u.row.question.code=c,rules:[c=>!!c||"Por favor indicar a Sequ\xEAncia/codigo na Ficha"],"lazy-rules":"",min:1},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1032,["props"]),t(V,{key:"evaluationType"},{default:a(()=>[t(H,{class:"vertical-middle","fill-input":"","input-debounce":"0",disable:!u.row.selected,dense:"",outlined:"",ref:"evaluationTypeRef",modelValue:u.row.evaluationType,"onUpdate:modelValue":c=>u.row.evaluationType=c,rules:[c=>!!c||"Por favor indicar o Tipo de Avalia\xE7\xE3o"],"lazy-rules":"","option-value":"id","option-label":"description",options:D.value},null,8,["disable","modelValue","onUpdate:modelValue","rules","options"])]),_:2},1024),t(V,{key:"responseType"},{default:a(()=>[t(H,{class:"vertical-middle","fill-input":"","input-debounce":"0",dense:"",outlined:"",disable:!u.row.selected,ref:"responseTypeRef",modelValue:u.row.responseType,"onUpdate:modelValue":c=>u.row.responseType=c,rules:[c=>!!c||"Por favor indicar o Tipo de Resposta"],"lazy-rules":"","option-value":"id","option-label":"description",options:O.value},null,8,["disable","modelValue","onUpdate:modelValue","rules","options"])]),_:2},1024),t(V,{key:"options",props:u},{default:a(()=>[m("div",_t,[t(ot,{modelValue:u.row.selected,"onUpdate:modelValue":c=>u.row.selected=c,onClick:c=>z(u.row)},null,8,["modelValue","onUpdate:modelValue","onClick"])])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows"])]),m("div",Tt,[t(ue),t(T,{label:"Cancelar",class:"float-right",color:"red",onClick:i[9]||(i[9]=u=>l.value=!1)}),t(T,{class:"float-right q-ml-md",type:"submit",label:"Adicionar Seleccionadas",color:"primary",onClick:i[10]||(i[10]=u=>te())})])])])]),_:1}))}};const St={key:0},Vt={class:"q-ma-md page-container"},kt={class:"page-input-container q-pa-md"},Rt={class:"row q-mt-lg"},Pt={class:"col"},Ot={class:"col"},xt={class:"row"},Et={class:"row"},$t={class:"row"},Qt={class:"col"},Ut={class:"row"},Bt={class:"row q-my-sm"},It={key:1},Dt={class:"q-ma-md page-container"},Nt={class:"page-input-container q-pa-md"},Lt={class:"q-mt-lg"},zt={style:{color:"amber-10"}},Gt={class:"full-width row flex-center text-primary q-gutter-sm text-body2"},Mt={class:"row q-my-sm q-mt-lg"},jt={__name:"ManageForm",emits:["goToFormQuestions","close"],setup(s,{emit:l}){const e=g(new ee);e.value.programmaticArea=new Te,e.value.programmaticArea.program=new Ee,se("step");const y=g([]),w=l,q=g(new $e),A=g(null),k=g(null),R=g(null),O=g(null),D=g(null),N=g(!1),P=g(!1),C=g(!1),L=g([]),z=Be(g(new I({question:new re({questionCategory:new pe}),evaluationType:new B,responseType:new j}))),{alertError:te,alertSucess:ae,alertWarningAction:d}=_e(),i=[{name:"evaluationType",align:"left",label:"Tipo de Avalia\xE7\xE3o",field:b=>b.evaluationType,sortable:!1},{name:"questionCategory",align:"left",label:"Categoria",field:b=>b.question.questionCategory,sortable:!1},{name:"question",align:"left",label:"Descri\xE7\xE3o",field:b=>b.question,sortable:!1},{name:"options",align:"left",label:"Op\xE7\xF5es",sortable:!1}],u=se("selectedForm"),c=se("isNewForm");Ve(()=>{q.value=JSON.parse(JSON.stringify(Qe.getLogedUser())),x()});const x=()=>{c.value||(e.value=K.getById(u.value.id)),u.value=null,N.value=!0,P.value=!1},ye=M(()=>Fe.piniaGetAll()),v=()=>{L.value=e.value.formQuestions},n=M(()=>e.value.programmaticArea.program!==null&&e.value.programmaticArea.program!==void 0?Se.getProgrammaticAreasByProgramaId(e.value.programmaticArea.program.id):null),f=(b,r,o)=>{const F=n;b===""?r(()=>{y.value=F.value.map(_=>_)}):F.value.length===0?r(()=>{y.value=[]}):r(()=>{y.value=F.value.map(_=>_).filter(_=>_&&_.name.toLowerCase().indexOf(b.toLowerCase())!==-1)})},E=()=>{z.value=null,u.value=null,c.value=!0,w("close")},J=b=>{A.value.validate(),k.value.validate(),R.value.validate(),O.value.validate(),D.value.validate(),!A.value.hasError&&!k.value.hasError&&!R.value.hasError&&!O.value.hasError&&!D.value.hasError&&(Object.assign({},b),c.value||Le(b),z.value=L.value,N.value=!1,P.value=!0)},Le=b=>{const r={formId:b.id};Object.keys(r).forEach(o=>r[o]===""&&delete r[o]),xe.search(r).then(o=>{z.value=o.data,z.value.forEach(F=>{b.formQuestions.push(F)})}).catch(o=>{console.error(o)})},ze=b=>{d("Tem certeza que deseja remover esta compet\xEAncia?").then(r=>{if(r)if(b.id===null)e.value.formQuestions.pop(b);else{const o={userId:q.value.id,formId:e.value.id};Object.keys(o).forEach(_=>o[_]===""&&delete o[_]),xe.remove(o,b).then(_=>{ae("Compet\xEAncia removida com sucesso!")}).catch(_=>{console.error(_),te("Ocorreu um erro ao remover esta compet\xEAncia!")});const F=e.value.formQuestions.filter(_=>_.id!==b.id);e.value.formQuestions=F}})},Ge=b=>{const r={userId:q.value.id};Object.keys(r).forEach(o=>r[o]===""&&delete r[o]),d("Tem certeza que deseja guardar as altera\xE7\xF5es?").then(o=>{o&&K.saveOrUpdate(b).then(F=>{F.status===201?(ae("Tabela de Compet\xEAncias registada com sucesso!").then(_=>{_&&w("close")}),L.value=b.formQuestions):te("N\xE3o foi possivel gravar por ocorr\xEAncia de um erro.")}).catch(F=>{console.error(F)})})};return Y("showAddOrRemoveQuestions",C),Y("addedFormQuestions",z),Y("searchResults",L),Y("selectedForm",e),(b,r)=>(W(),le(et,null,[N.value?(W(),le("div",St,[m("div",Vt,[m("div",kt,[t(we,{dense:"","inline-actions":"",class:"text-white bg-primary q-px-md"},{action:a(()=>[t(tt,{src:at})]),default:a(()=>[r[16]||(r[16]=p(" Identifica\xE7\xE3o da Tabela de Compet\xEAncias "))]),_:1}),m("div",Rt,[m("div",Pt,[t(H,{class:"row","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",dense:"",outlined:"",ref_key:"programRef",ref:A,rules:[o=>!!o||"Por favor indicar o Programa"],"lazy-rules":"",modelValue:e.value.programmaticArea.program,"onUpdate:modelValue":r[0]||(r[0]=o=>e.value.programmaticArea.program=o),options:ye.value,"option-value":"id","option-label":"name",label:"Programa"},{"no-option":a(()=>[t(ie,null,{default:a(()=>[t(ne,{class:"text-grey"},{default:a(()=>r[17]||(r[17]=[p(" Sem Resultados ")])),_:1})]),_:1})]),_:1},8,["rules","modelValue","options"])]),m("div",Ot,[t(H,{class:"col q-ml-md","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",dense:"",outlined:"",ref_key:"programmaticAreaRef",ref:k,rules:[o=>!!o||"Por favor indicar a \xC1rea de Mentoria"],"lazy-rules":"",modelValue:e.value.programmaticArea,"onUpdate:modelValue":r[1]||(r[1]=o=>e.value.programmaticArea=o),options:y.value,"option-value":"id","option-label":"name",onFilter:f,label:"\xC1rea de Mentoria"},{"no-option":a(()=>[t(ie,null,{default:a(()=>[t(ne,{class:"text-grey"},{default:a(()=>r[18]||(r[18]=[p(" Sem Resultados ")])),_:1})]),_:1})]),_:1},8,["rules","modelValue","options"])])]),m("div",xt,[t(G,{outlined:"",label:"Nome",dense:"",ref_key:"nameRef",ref:R,rules:[o=>!!o||"Por favor indicar o Nome"],"lazy-rules":"",class:"col",modelValue:e.value.name,"onUpdate:modelValue":[r[3]||(r[3]=o=>e.value.name=o),r[4]||(r[4]=o=>b.filter=o)]},{append:a(()=>[t(U,{name:"close",onClick:r[2]||(r[2]=o=>e.value.name=""),class:"cursor-pointer"})]),_:1},8,["rules","modelValue"])]),m("div",Et,[t(G,{outlined:"",label:"Descri\xE7\xE3o",dense:"",ref:"descriptionRef",rules:[o=>!!o||"Por favor indicar a Descri\xE7\xE3o"],"lazy-rules":"",class:"col",modelValue:e.value.description,"onUpdate:modelValue":[r[6]||(r[6]=o=>e.value.description=o),r[7]||(r[7]=o=>b.filter=o)]},{append:a(()=>[t(U,{name:"close",onClick:r[5]||(r[5]=o=>e.value.description=""),class:"cursor-pointer"})]),_:1},8,["rules","modelValue"])]),m("div",$t,[m("div",Qt,[m("div",Ut,[t(G,{class:"col",label:"N\xFAmero de Observa\xE7\xF5es de Consulta",outlined:"",dense:"",ref_key:"targetPatientRef",ref:O,rules:[o=>!!o||"Por favor indicar o N\xFAmero de Observa\xE7\xF5es de Consulta"],"lazy-rules":"",modelValue:e.value.targetPatient,"onUpdate:modelValue":r[8]||(r[8]=o=>e.value.targetPatient=o),type:"number",min:1},null,8,["rules","modelValue"]),t(G,{class:"col q-ml-md",outlined:"",label:"N\xFAmero de Avalia\xE7\xE3o de Fichas",dense:"",ref_key:"targetFileRef",ref:D,rules:[o=>!!o||"Por favor indicar o N\xFAmero de Avalia\xE7\xE3o de Fichas"],"lazy-rules":"",modelValue:e.value.targetFile,"onUpdate:modelValue":r[9]||(r[9]=o=>e.value.targetFile=o),type:"number",min:1},null,8,["rules","modelValue"])])])]),m("div",Bt,[t(ue),t(T,{label:"Cancelar",class:"float-right",color:"red",onClick:E}),t(T,{class:"float-right q-ml-md",type:"submit",label:"Avan\xE7ar",color:"primary",onClick:r[10]||(r[10]=o=>J(e.value))})])])])])):ve("",!0),P.value?(W(),le("div",It,[m("div",Dt,[m("form",{onSubmit:r[13]||(r[13]=Ze((...o)=>b.submitForm&&b.submitForm(...o),["prevent"])),ref:"myForm"},[m("div",Nt,[m("div",Lt,[t(we,{dense:"","inline-actions":"",class:"text-white bg-primary q-px-sm"},{action:a(()=>[t(T,{flat:"",round:"",dense:"",size:"md",class:"q-ml-md",color:"white",icon:"add_circle",onClick:r[11]||(r[11]=o=>C.value=!0)},{default:a(()=>[t(Q,{class:"bg-green-5"},{default:a(()=>r[19]||(r[19]=[p("Adicionar Compet\xEAncias")])),_:1})]),_:1})]),default:a(()=>[r[20]||(r[20]=p(" Compet\xEAncias Associadas \xE0 ")),m("span",zt,"["+h(e.value.name)+"]",1)]),_:1})]),m("div",null,[t(Ae,{class:"col",dense:"",flat:"","wrap-cells":"",rows:e.value.formQuestions,columns:i,"row-key":"uuid"},{"no-data":a(({icon:o,filter:F})=>[m("div",Gt,[r[21]||(r[21]=m("span",null," Sem resultados para visualizar ",-1)),t(U,{size:"2em",name:F?"filter_b_and_w":o},null,8,["name"])])]),header:a(o=>[t(de,{class:"text-left bg-grey-3",props:o},{default:a(()=>[t($,{style:{width:"70px"}},{default:a(()=>[p(h(i[0].label),1)]),_:1}),t($,{style:{width:"110px"}},{default:a(()=>[p(h(i[1].label),1)]),_:1}),t($,{style:{width:"120px"}},{default:a(()=>[p(h(i[2].label),1)]),_:1}),t($,{style:{width:"190px"}},{default:a(()=>[p(h(i[3].label),1)]),_:1})]),_:2},1032,["props"])]),body:a(o=>[t(de,{props:o},{default:a(()=>[t(V,{key:"evaluationType",props:o},{default:a(()=>[p(h(o.row.evaluationType.description),1)]),_:2},1032,["props"]),t(V,{key:"questionCategory",props:o},{default:a(()=>[p(h(o.row.question.questionCategory.category),1)]),_:2},1032,["props"]),t(V,{key:"question",props:o},{default:a(()=>[p(h(o.row.question.question),1)]),_:2},1032,["props"]),t(V,{key:"options",props:o},{default:a(()=>[t(T,{flat:"",round:"",class:"",color:"red",icon:"close",onClick:F=>ze(o.row)},{default:a(()=>[t(Q,{class:"bg-green-5"},{default:a(()=>r[22]||(r[22]=[p("Remover a Compet\xEAncia")])),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows"])]),m("div",Mt,[t(ue),t(T,{label:"Cancelar",class:"float-right",color:"red",onClick:E}),t(T,{class:"float-right q-ml-md",type:"submit",loading:v(),label:"Terminar",color:"primary",onClick:r[12]||(r[12]=o=>Ge(e.value))},null,8,["loading"])])])],544)])])):ve("",!0),t(st,{persistent:"",modelValue:C.value,"onUpdate:modelValue":r[15]||(r[15]=o=>C.value=o)},{default:a(()=>[t(Ft,{onClose:r[14]||(r[14]=o=>C.value=!1)})]),_:1},8,["modelValue"])],64))}},Jt={style:{height:"100%"}},pa={__name:"Forms",setup(s){const{closeLoading:l,showloading:e}=Ke(),y=g(""),w=g(null),q=g(!0);Ve(()=>{e(),R("search"),D()});const A=M(()=>y.value==="search"),k=M(()=>y.value==="create"),R=P=>{y.value=P},O=P=>{w.value=P,q.value=!1,R("create")},D=()=>{Fe.getAll(),Se.getAll(),Ue.getAll(),De.getAll(),Ne.getAll(),l()},N=()=>{R("search")};return Y("step",y),Y("selectedForm",w),Y("isNewForm",q),(P,C)=>(W(),le("div",Jt,[A.value?(W(),qe(ft,{key:0,onCreate:C[0]||(C[0]=L=>R("create")),onGoToForms:O})):ve("",!0),k.value?(W(),qe(jt,{key:1,onGoToForms:O,onClose:N})):ve("",!0)]))}};export{pa as default};
