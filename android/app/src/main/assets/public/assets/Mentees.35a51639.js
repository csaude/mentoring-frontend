import{Q as v,g as z}from"./QBtn.bc754139.js";import{Q as w,u as Qe}from"./dialog.985b2618.js";import{Q as ce,a as Z,b as _e,c as T,d as Le,e as M,u as De}from"./loading.39fe8a47.js";import{Q as $,b as A,d as P}from"./selection.524514e5.js";import{a as K,E as ee,b as Ie,U as Be,L as de,Q as Ge}from"./QSpinnerRings.4e4bdf31.js";import{c as Ye,d as W}from"./index.806c5219.js";import{M as E}from"./Mentees.fe248e73.js";import{r as d,i as le,Q as ve,o as ae,U,af as ne,X as r,f as t,W as n,_ as g,Y as x,Z as je,c as R,ah as He,V as oe,$ as te,a0 as X,G as me}from"./index.8cc0be75.js";import{Q as Je,_ as Ze}from"./mentoring.31b55a37.js";import{Q as We}from"./QBanner.7f8ff127.js";import{p as Xe,b as fe,d as ye,a as se,h as ge}from"./professionalCategoryService.4e4f2e8e.js";import{u as Ke}from"./stringUtils.75fc7862.js";import"./_commonjsHelpers.468b0bfa.js";import"./format.2d67676e.js";import"./QCheckbox.435b6968.js";import"./axios.0ed95acd.js";function be(){function f(o){const{createEmployeeFromDTO:y}=K();return new E({id:o.id,uuid:o.uuid,employee:y(o.employeeDTO)})}function m(o){const{createDTOFromEmployee:y}=K();return{id:o.id,uuid:o.uuid,employeeDTO:y(o.employee)}}return{createMenteesFromDTO:f,createDTOFromMentees:m}}const F=Ye(E),{createMenteesFromDTO:pe}=be();var Q={async search(f){return await W().get(`/tutored/search?${new URLSearchParams(f).toString()}`).then(m=>(this.generateAndSaveMenteesFromDTO(m.data),m))},async update(f){return await W().patch("/tutored/update",f).then(m=>(F.save(pe(m.data)),m)).catch(m=>{console.error("Error",m)})},async getByUuid(f){return await W().get(`/tutored/${f}`).then(m=>(this.generateAndSaveMenteesFromDTO(m.data),m)).catch(m=>{console.error("Error",m.message)})},generateAndSaveMenteesFromDTO(f){f.forEach(m=>{const o=pe(m);F.save(o)})},deleteAllFromStorage(){F.flush()},getMenteesList(){return F.query().withAllRecursive(2).orderBy("id","asc").get()},getById(f){return F.query().withAllRecursive(3).where("id",f).orderBy("id","asc").first()}};const el={class:"q-pt-sm",style:{height:"100%"}},ll={class:"q-ma-md q-pa-md page-container"},ol={class:"row"},tl={class:"q-mt-lg q-mb-md"},sl={class:"row items-center q-mb-md"},al={class:"full-width row flex-center text-primary q-gutter-sm text-body2"},nl={class:"col"},rl={__name:"SearchMentees",emits:["goToMenteesEdit"],setup(f,{emit:m}){const o=d(new E({employee:new ee})),{fullName:y}=K();le("step");const q=d([]),N=d("");ve();const O=[{name:"nuit",align:"left",label:"NUIT",sortable:!1},{name:"name",align:"left",label:"Nome",field:p=>y(p.employee),sortable:!1},{name:"category",align:"center",label:"Categoria Profissional",sortable:!1},{name:"phoneNumber",align:"left",label:"Telefone",sortable:!1},{name:"options",align:"left",label:"Op\xE7\xF5es",sortable:!1}],V=d(new Ie),h=m;ae(()=>{V.value=JSON.parse(JSON.stringify(Be.getLogedUser()))});const S=()=>{o.value=new E({employee:new ee})},k=async p=>{N.value=p,h("goToMenteesEdit",p)},b=()=>{const p={userId:V.value.id,name:o.value.employee.name,phoneNumber:o.value.employee.phoneNumber,nuit:o.value.employee.nuit};Object.keys(p).forEach(s=>p[s]===""&&delete p[s]),Q.search(p).then(s=>{q.value=Q.getMenteesList()}).catch(s=>{console.error(s)})};return(p,s)=>(U(),ne("div",el,[r("div",ll,[r("div",ol,[t(w,{outlined:"",label:"Nome",dense:"",ref:"nameRef",class:"col",modelValue:o.value.employee.name,"onUpdate:modelValue":[s[1]||(s[1]=i=>o.value.employee.name=i),s[2]||(s[2]=i=>p.filter=i)]},{append:n(()=>[t(v,{name:"close",onClick:s[0]||(s[0]=i=>o.value.employee.name=""),class:"cursor-pointer"})]),_:1},8,["modelValue"]),t(w,{outlined:"",label:"NUIT",dense:"",ref:"nuitRef",class:"col q-ml-md",modelValue:o.value.employee.nuit,"onUpdate:modelValue":[s[4]||(s[4]=i=>o.value.employee.nuit=i),s[5]||(s[5]=i=>p.filter=i)]},{append:n(()=>[t(v,{name:"close",onClick:s[3]||(s[3]=i=>o.value.employee.nuit=""),class:"cursor-pointer"})]),_:1},8,["modelValue"]),t(w,{outlined:"",label:"Telefone",dense:"",ref:"phoneRef",class:"col q-ml-md",modelValue:o.value.employee.phoneNumber,"onUpdate:modelValue":[s[7]||(s[7]=i=>o.value.employee.phoneNumber=i),s[8]||(s[8]=i=>p.filter=i)]},{append:n(()=>[t(v,{name:"close",onClick:s[6]||(s[6]=i=>o.value.employee.phoneNumber=""),class:"cursor-pointer"})]),_:1},8,["modelValue"]),t(ce),t(z,{onClick:b,class:"q-ml-md q-mb-xs float-right",square:"",color:"primary",icon:"search"},{default:n(()=>[t(Z,{class:"bg-green-5"},{default:n(()=>s[9]||(s[9]=[g("Pesquisar")])),_:1})]),_:1}),t(z,{onClick:S,class:"q-ml-md q-mb-xs float-right",square:"",color:"amber",icon:"clear"},{default:n(()=>[t(Z,{class:"bg-amber-5"},{default:n(()=>s[10]||(s[10]=[g("Limpar")])),_:1})]),_:1})]),r("div",tl,[r("div",sl,[t(v,{name:"search",size:"sm"}),s[11]||(s[11]=r("span",{class:"q-pl-sm text-subtitle2"},"Resultado da Pesquisa",-1))]),t($,{color:"grey-13",size:"1px"})]),r("div",null,[t(Le,{class:"col",dense:"",rows:q.value,columns:O,"row-key":"id"},{"no-data":n(({icon:i,filter:C})=>[r("div",al,[s[12]||(s[12]=r("span",null," Sem resultados para visualizar ",-1)),t(v,{size:"2em",name:C?"filter_b_and_w":i},null,8,["name"])])]),body:n(i=>[t(_e,{props:i},{default:n(()=>[t(T,{key:"nuit",props:i},{default:n(()=>[g(x(i.row.employee.nuit),1)]),_:2},1032,["props"]),t(T,{key:"name",props:i},{default:n(()=>[g(x(je(y)(i.row.employee)),1)]),_:2},1032,["props"]),t(T,{key:"category",props:i},{default:n(()=>[g(x(i.row.employee.professionalCategory.description),1)]),_:2},1032,["props"]),t(T,{key:"phoneNumber",props:i},{default:n(()=>[g(x(i.row.employee.phoneNumber),1)]),_:2},1032,["props"]),t(T,{key:"options",props:i},{default:n(()=>[r("div",nl,[t(z,{flat:"",round:"",class:"q-ml-md",color:"green-8",icon:"edit",onClick:C=>k(i.row)},{default:n(()=>[t(Z,{class:"bg-green-5"},{default:n(()=>s[13]||(s[13]=[g("Editar Mentorados")])),_:1})]),_:2},1032,["onClick"])])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows"])])])]))}},il={class:"q-ma-md page-container"},ul={class:"q-ma-md"},dl={class:"page-input-container q-pa-md"},ml={class:"q-mt-lg"},pl={class:"row items-center q-mb-md"},cl={class:"row q-my-sm"},vl={class:"row q-my-sm q-mt-md"},fl={class:"q-mt-lg"},yl={class:"row items-center q-mb-md"},gl={class:"row q-my-sm"},bl={class:"q-mt-lg"},Vl={class:"row items-center q-mb-md"},wl={class:"row q-my-sm"},ql={class:"row q-my-sm"},Sl={class:"q-mt-lg"},kl={class:"row items-center q-mb-md"},Rl={class:"row q-my-sm"},Nl={class:"row q-my-sm"},Cl={__name:"EditMentees",emits:["editMentees","close"],setup(f,{emit:m}){const o=d(new E({employee:new ee({locations:[{location:new de}]})})),y=m,{createDTOFromMentees:q}=be(),{stringContains:N}=Ke(),{alertSucess:O,alertError:V,alertSucessAction:h}=Qe(),S=d([]),k=d([]),b=d([]),p=d([]),s=d(""),i=d(["SNS","ONG"]);d(new de);const C=d(null),_=d(null),re=d(null),L=d(null),D=d(null),I=d(null),B=d(null),G=d(null),Y=d(null),j=d(null),H=d(null),J=d(null);ve();const ie=le("selectedMentee");le("step"),o.value=Q.getById(ie.value.id),ae(()=>{s.value=ie.value.employee.partner.name==="MISAU"?"SNS":"ONG"});const Ve=R(()=>Xe.piniaGetAll()),we=R(()=>s.value==="ONG"),qe=R(()=>fe.piniaGetAll()),Se=R(()=>o.value.employee.locations[0].province!==null&&o.value.employee.locations[0].province!==void 0?ye.getAllDistrictByProvinceId(o.value.employee.locations[0].province.id):null),ke=R(()=>se.piniaGetAll()),Re=d(null),Ne=()=>{if(C.value.validate(),_.value.validate(),re.value.validate(),L.value.validate(),D.value.validate(),I.value.validate(),B.value.validate(),G.value.validate(),Y.value!==null&&Y.value.validate(),j.value.validate(),H.value.validate(),J.value.validate(),!C.value.hasError&&!_.value.hasError&&!L.value.hasError&&!D.value.hasError&&!I.value.hasError&&!B.value.hasError&&!G.value.hasError&&!j.value.hasError&&!H.value.hasError&&!J.value.hasError){X.show({spinner:Ge});const a=Object.assign({},o.value);Q.update(q(new E(a))).then(e=>{e.status===200||e.status===201?O("Mentorando actualizado.").then(l=>{ue()}):V(e.message),X.hide()}).catch(e=>{X.hide(),console.error("Error",e.message),V("Ocorreu um erro inesperado nesta opera\xE7\xE3o.")})}},Ce=a=>/^[A-Za-z0-9+_.-]+@(.+)$/.test(a),Me=a=>a!==""&&!N(a,"#"),Ue=a=>a!==""&&!N(a,"#"),Ee=a=>a>=1960,Oe=a=>a<=new Date().getFullYear(),he=a=>a!==""&&!N(a,"_"),Te=(a,e,l)=>{const c=ke;a===""?e(()=>{p.value=c.value.map(u=>u)}):c.value.length===0?e(()=>{p.value=[]}):e(()=>{p.value=c.value.map(u=>u).filter(u=>u&&u.description.toLowerCase().indexOf(a.toLowerCase())!==-1)})},Fe=(a,e,l)=>{const c=Se;a===""?e(()=>{S.value=c.value.map(u=>u)}):c.value.length===0?e(()=>{S.value=[]}):e(()=>{S.value=c.value.map(u=>u).filter(u=>u&&u.description.toLowerCase().indexOf(a.toLowerCase())!==-1)})},$e=R(()=>o.value.employee.locations[0].district!==null&&o.value.employee.locations[0].district!==void 0?ge.getAllOfDistrict(o.value.employee.locations[0].district.id):null),ze=(a,e,l)=>{const c=$e;a===""?e(()=>{k.value=c.value.map(u=>u)}):c.value.length===0?e(()=>{k.value=[]}):e(()=>{k.value=c.value.map(u=>u).filter(u=>u&&u.healthFacility.toLowerCase().indexOf(a.toLowerCase())!==-1)})},Ae=(a,e,l)=>{const c=qe;a===""?e(()=>{b.value=c.value.map(u=>u)}):c.value.length===0?e(()=>{b.value=[]}):e(()=>{b.value=c.value.map(u=>u).filter(u=>u&&u.description.toLowerCase().indexOf(a.toLowerCase())!==-1)})},Pe=()=>{o.value.employee.locations[0].district="",o.value.employee.locations[0].district=""},ue=()=>{y("close")},xe=a=>{a==="SNS"?o.value.employee.partner=se.getByName("MISAU"):o.value.employee.partner=""};return(a,e)=>(U(),ne("div",null,[r("div",il,[r("form",{onSubmit:He(Ne,["prevent"]),ref_key:"myForm",ref:Re},[r("div",ul,[t(We,{dense:"","inline-actions":"",class:"text-white bg-primary q-px-md"},{action:n(()=>[t(Je,{src:Ze})]),default:n(()=>[e[27]||(e[27]=g(" Dados do Mentorado "))]),_:1}),r("div",dl,[r("div",ml,[r("div",pl,[t(v,{name:"person_outline",size:"sm"}),e[28]||(e[28]=r("span",{class:"q-pl-sm text-subtitle2"},"Identifica\xE7\xE3o do Mentorado",-1))]),t($,{color:"grey-13",size:"1px"})]),r("div",cl,[t(w,{outlined:"",label:"Nome",dense:"",ref_key:"nameRef",ref:C,rules:[l=>!!l||"Por favor indicar o nome"],"lazy-rules":"",class:"col",modelValue:o.value.employee.name,"onUpdate:modelValue":[e[1]||(e[1]=l=>o.value.employee.name=l),e[2]||(e[2]=l=>a.filter=l)]},{append:n(()=>[t(v,{name:"close",onClick:e[0]||(e[0]=l=>o.value.employee.name=""),class:"cursor-pointer"})]),_:1},8,["rules","modelValue"]),t(w,{outlined:"",label:"Apelido",dense:"",rules:[l=>!!l||"Por favor indicar o apelido"],"lazy-rules":"",ref_key:"surnameRef",ref:_,class:"col q-ml-md",modelValue:o.value.employee.surname,"onUpdate:modelValue":[e[4]||(e[4]=l=>o.value.employee.surname=l),e[5]||(e[5]=l=>a.filter=l)]},{append:n(()=>[t(v,{name:"close",onClick:e[3]||(e[3]=l=>o.value.employee.surname=""),class:"cursor-pointer"})]),_:1},8,["rules","modelValue"])]),r("div",vl,[t(w,{outlined:"",label:"NUIT",dense:"",ref_key:"nuitRef",ref:re,class:"col",mask:"#########","lazy-rules":"",rules:[l=>Me(l)||"Por favor indicar um NUIT v\xE1lido."],"fill-mask":"#",modelValue:o.value.employee.nuit,"onUpdate:modelValue":[e[7]||(e[7]=l=>o.value.employee.nuit=l),e[8]||(e[8]=l=>a.filter=l)]},{append:n(()=>[t(v,{name:"close",onClick:e[6]||(e[6]=l=>o.value.employee.nuit=""),class:"cursor-pointer"})]),_:1},8,["rules","modelValue"]),e[29]||(e[29]=r("span",{class:"col"},null,-1))]),r("div",fl,[r("div",yl,[t(v,{name:"call",size:"sm"}),e[30]||(e[30]=r("span",{class:"q-pl-sm text-subtitle2"},"Contacto",-1))]),t($,{color:"grey-13",size:"1px"})]),r("div",gl,[t(w,{outlined:"",label:"Numero de Telefone",dense:"",ref_key:"phoneNumberRef",ref:L,mask:"#########",hint:"Formato: #########","lazy-rules":"",rules:[l=>he(l)||"Por favor indicar um contacto v\xE1lido."],"fill-mask":"#",class:"col",modelValue:o.value.employee.phoneNumber,"onUpdate:modelValue":e[10]||(e[10]=l=>o.value.employee.phoneNumber=l),"onUpdate:menteeValue":e[11]||(e[11]=l=>a.filter=l)},{append:n(()=>[t(v,{name:"close",onClick:e[9]||(e[9]=l=>o.value.employee.phoneNumber=""),class:"cursor-pointer"})]),_:1},8,["rules","modelValue"]),t(w,{outlined:"",label:"Email",dense:"",ref_key:"emailRef",ref:D,class:"col q-ml-md",rules:[l=>Ce(l)||"Email inv\xE1lido"],"lazy-rules":"",modelValue:o.value.employee.email,"onUpdate:modelValue":e[13]||(e[13]=l=>o.value.employee.email=l),"onUpdate:menteeValue":e[14]||(e[14]=l=>a.filter=l)},{append:n(()=>[t(v,{name:"close",onClick:e[12]||(e[12]=l=>o.value.employee.email=""),class:"cursor-pointer"})]),_:1},8,["rules","modelValue"])]),r("div",bl,[r("div",Vl,[t(v,{name:"engineering",size:"sm"}),e[31]||(e[31]=r("span",{class:"q-pl-sm text-subtitle2"},"Informa\xE7\xE3o Laboral",-1))]),t($,{color:"grey-13",size:"1px"})]),r("div",wl,[t(M,{class:"col","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",dense:"",outlined:"",ref_key:"categoryRef",ref:I,rules:[l=>!!l||"Por favor indicar a categoria profissional"],"lazy-rules":"",modelValue:o.value.employee.professionalCategory,"onUpdate:modelValue":e[15]||(e[15]=l=>o.value.employee.professionalCategory=l),options:b.value,"option-value":"id","option-label":"description",onFilter:Ae,label:"Categoria Profissional"},{"no-option":n(()=>[t(A,null,{default:n(()=>[t(P,{class:"text-grey"},{default:n(()=>e[32]||(e[32]=[g(" Sem Resultados ")])),_:1})]),_:1})]),_:1},8,["rules","modelValue","options"]),t(w,{outlined:"",label:"Ano de Forma\xE7\xE3o",dense:"",ref_key:"trainingYearRef",ref:B,rules:[l=>Ue(l)||"Ano de forma\xE7\xE3o inv\xE1lido",l=>Ee(l)||"Ano tem que ser superior a 1960",l=>Oe(l)||"Ano nao pode ser superior ao Ano Atual "+new Date().getFullYear()],"lazy-rules":"",mask:"####","fill-mask":"#",min:"1960",class:"col q-ml-md",modelValue:o.value.employee.trainingYear,"onUpdate:modelValue":[e[17]||(e[17]=l=>o.value.employee.trainingYear=l),e[18]||(e[18]=l=>a.filter=l)]},{append:n(()=>[t(v,{name:"close",onClick:e[16]||(e[16]=l=>o.value.employee.trainingYear=""),class:"cursor-pointer"})]),_:1},8,["rules","modelValue"]),t(M,{class:"col q-ml-md","use-input":"","hide-selected":"","onUpdate:modelValue":[e[19]||(e[19]=l=>xe(l)),e[20]||(e[20]=l=>s.value=l)],"fill-input":"","input-debounce":"0",dense:"",outlined:"",ref_key:"vinculoRef",ref:G,"lazy-rules":"",rules:[l=>!!l||"Por favor indicar o V\xEDnculo Laboral"],modelValue:s.value,options:i.value,label:"V\xEDnculo Laboral"},null,8,["rules","modelValue","options"])]),r("div",ql,[we.value?(U(),oe(M,{key:0,class:"col-4","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",dense:"",outlined:"",ref_key:"partnerRef",ref:Y,"lazy-rules":"",rules:[l=>!!l||"Por favor indicar o Nome da ONG"],modelValue:o.value.employee.partner,"onUpdate:modelValue":e[21]||(e[21]=l=>o.value.employee.partner=l),options:p.value,"option-value":"id","option-label":"description",onFilter:Te,label:"Nome da ONG"},{"no-option":n(()=>[t(A,null,{default:n(()=>[t(P,{class:"text-grey"},{default:n(()=>e[33]||(e[33]=[g(" Sem Resultados ")])),_:1})]),_:1})]),_:1},8,["rules","modelValue","options"])):te("",!0)]),r("div",Sl,[r("div",kl,[t(v,{name:"local_hospital",size:"sm"}),e[34]||(e[34]=r("span",{class:"q-pl-sm text-subtitle2"},"Unidade Sanit\xE1ria",-1))]),t($,{color:"grey-13",size:"1px"})]),r("div",Rl,[t(M,{class:"col","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0","onUpdate:modelValue":[e[22]||(e[22]=l=>Pe()),e[23]||(e[23]=l=>o.value.employee.locations[0].province=l)],dense:"",outlined:"",ref_key:"provinceRef",ref:j,"lazy-rules":"",rules:[l=>!!l||"Por favor indicar a Prov\xEDncia"],modelValue:o.value.employee.locations[0].province,options:Ve.value,"option-value":"id","option-label":"designation",label:"Prov\xEDncia"},null,8,["rules","modelValue","options"]),t(M,{class:"col q-ml-md","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",dense:"",outlined:"",ref_key:"districtRef",ref:H,"lazy-rules":"",rules:[l=>!!l||"Por favor indicar o Distrito"],modelValue:o.value.employee.locations[0].district,"onUpdate:modelValue":e[24]||(e[24]=l=>o.value.employee.locations[0].district=l),options:S.value,"option-value":"id","option-label":"description",onFilter:Fe,label:"Distrito"},{"no-option":n(()=>[t(A,null,{default:n(()=>[t(P,{class:"text-grey"},{default:n(()=>e[35]||(e[35]=[g(" Sem Resultados ")])),_:1})]),_:1})]),_:1},8,["rules","modelValue","options"]),t(M,{class:"col q-ml-md","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",dense:"",outlined:"",ref_key:"hfRef",ref:J,"lazy-rules":"",rules:[l=>!!l||"Por favor indicar a Unidade Sanit\xE1ria"],modelValue:o.value.employee.locations[0].healthFacility,"onUpdate:modelValue":e[25]||(e[25]=l=>o.value.employee.locations[0].healthFacility=l),options:k.value,"option-value":"id","option-label":"healthFacility",onFilter:ze,label:"Unidade Sanit\xE1ria"},{"no-option":n(()=>[t(A,null,{default:n(()=>[t(P,{class:"text-grey"},{default:n(()=>e[36]||(e[36]=[g(" Sem Resultados ")])),_:1})]),_:1})]),_:1},8,["rules","modelValue","options"])]),r("div",Nl,[t(ce),t(z,{label:"Cancelar",class:"float-right",color:"red",onClick:e[26]||(e[26]=l=>ue())}),t(z,{class:"float-right q-ml-md",type:"submit",label:"Submeter",color:"primary"})])])])],544)])]))}},Ml={style:{height:"100%"}},Bl={__name:"Mentees",setup(f){const{closeLoading:m,showloading:o}=De(),y=d(""),q=d(null);ae(()=>{o(),V("search"),S()});const N=R(()=>y.value==="search"),O=R(()=>y.value==="edit"),V=b=>{y.value=b},h=b=>{q.value=b,V("edit")},S=()=>{ye.getAll(),ge.getAll(),fe.getAll(),se.getAll(),m()},k=()=>{V("search")};return me("step",y),me("selectedMentee",q),(b,p)=>(U(),ne("div",Ml,[N.value?(U(),oe(rl,{key:0,onCreate:p[0]||(p[0]=s=>V("edit")),onGoToMenteesEdit:h})):te("",!0),O.value?(U(),oe(Cl,{key:1,onGoToMenteesEdit:h,onClose:k})):te("",!0)]))}};export{Bl as default};
